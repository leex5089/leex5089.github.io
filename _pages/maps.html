 
<html>
<head>
    <meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=5,maximum-scale=5,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.40.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.40.0/mapbox-gl.css' rel='stylesheet' />
    <script src="//d3js.org/d3.v4.js"></script>
    <style>
.page-template-full-width .content-area {
    width: 100%;
    margin: 0;
    border:0;
    padding:0;
}
 
.page-template-full-width .site {
margin:0px;
}

body { margin:0; padding:0; }
        #map {
    height: 102220%;
    width: 100%;
    left: 0;
    position: absolute;
    top:0;     }
    </style>
</head>
<body>

<style>
.map-overlay {
    font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    position: absolute;
    width: 10%;
    top: 0;
    left: 0;
    padding: 10px;
}
 
.map-overlay .map-overlay-inner2 {
    background-color: #fff;
    box-shadow:0 1px 2px rgba(0, 0, 0, 0.20);
    border-radius: 20px;
    padding: 5px;
    top: 90;
    position: absolute;
    margin-bottom:0; 
}
.map-overlay .map-overlay-inner {
    background-color: #fff;
    box-shadow:20 20px 2px rgba(0, 0, 0, 0.20);
    border-radius: 2px;
    padding: 1px;
    margin-bottom: 12px;
}

.legend {
    background-color: #fff;
    border-radius: 20px;
    bottom: 30px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.10);
    font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    padding: 10px;
    position: absolute;
    right: 10px;
    z-index: 1;
}

.legend h4 {
    margin: 0 0 10px;
}

.legend div span {
    border-radius: 50%;
    display: inline-block;
    height: 10px;
    margin-right: 5px;
    width: 10px;
}

</style>

<div id='map'></div>
 
   
    

<div id='state-legend' class='legend'>
    <h4>Legend</h4>
    <div><span style='background-color: #848484'></span>Missing</div>
    <div><span style='background-color: #ff0000'></span>0</div>
    <div><span style='background-color: #ff976a'></span>0.5</div>
    <div><span style='background-color: #e0e8ff'></span>0.67</div>
    <div><span style='background-color: #98beff'></span>0.77</div>
    <div><span style='background-color: #3061ff'></span>0.77</div> 
  <div class='map-overlay2' id='features'><h4>Hover over a region!</h4><div id='pd'><h4>[Slots per kid]</h4></div></div> 
  <div id='pd_a'><h4>[Weekly total cost]</h4></div>
  
    </div>
  

<div id='county-legend' class='legend' style='display: none;'>
    <h4>Legend</h4>
    <div><span style='background-color: #848484'></span>Missing</div>
    <div><span style='background-color: #ff0000'></span>0</div>
    <div><span style='background-color: #ff976a'></span>0.5</div>
    <div><span style='background-color: #e0e8ff'></span>0.67</div>
    <div><span style='background-color: #98beff'></span>0.77</div>
    <div><span style='background-color: #3061ff'></span>0.97</div> 
    <div class='map-overlay2' id='features'><h4>Hover over a region!</h4><div id='pd2'><h4>[Slots per kid]</h4></div></div> 
  <div id='pd2_a'><h4>[Weekly total cost]</h4></div>
  </div>


<div id='ct-legend' class='legend' style='display: none;'>
    <h4>Legend</h4>
    <div><span style='background-color: #848484'></span>Missing</div>
    <div><span style='background-color: #ff0000'></span>0</div>
    <div><span style='background-color: #ff976a'></span>0.5</div>
    <div><span style='background-color: #e0e8ff'></span>0.67</div>
    <div><span style='background-color: #98beff'></span>0.77</div>
    <div><span style='background-color: #3061ff'></span>0.97</div> 
    <div class='map-overlay2' id='features'><h4>Hover over a region!</h4><div id='pd3'><h4>[Slots per kid]</h4></div></div> 
  <div id='pd3_a'><h4>[Weekly total cost]</h4></div>
  </div>




<div id='ct-legend' class='legend' style='display: none;'>
    <h4>Legend</h4>
    <div><span style='background-color: #848484'></span>Missing</div>
    <div><span style='background-color: #ff0000'></span>0</div>
    <div><span style='background-color: #ff976a'></span>0.5</div>
    <div><span style='background-color: #e0e8ff'></span>0.67</div>
    <div><span style='background-color: #98beff'></span>0.77</div>
    <div><span style='background-color: #3061ff'></span>0.97</div> 
    <div class='map-overlay2' id='features'><h4>Hover over a region!</h4><div id='pd3'><h4>[Slots per kid]</h4></div></div> 
  <div id='pd3_a'><h4>[Weekly total cost]</h4></div>
  </div>



 







  <div class='map-overlay bottom'>
    <div class='map-overlay-inner'>
        <h2>Time trend</h2>
        <label id='month'></label>
        <input id='slider' type='range' min='0' max='11' step='1' value='0' />
    </div>
 
<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoid29ubGVlIiwiYSI6ImNqYjY0bHZlczBvMnAzMm16OTlyYWFzYnYifQ.yaLx92dXVMk1NKp5Fp7HUg';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/wonlee/cjb64nlr819aj2snpizd02a1u',
    center: [-94, 46.5],
    minZoom: 2,
    zoom: 6
});

var zoomThreshold = 7;
var zoomThreshold1 =9;

map.on('load', function() {

    map.addSource('data_2015_county-8s4bt3', {
        'type': 'vector',
        'url': 'mapbox://wonlee.dzmehldk'
    });
    map.addSource('data_2015_sd-325i5c', {
        'type': 'vector',
        'url': 'mapbox://wonlee.3wg3r8gc'
    });
    map.addSource('data_2015_ct-8iqhhx', {
        'type': 'vector',
        'url': 'mapbox://wonlee.cavnsqxp'
    });
    
    map.addLayer({
        'id': 'data_2015_county-8s4bt3',
        'source': 'data_2015_county-8s4bt3',
        'source-layer': 'data_2015_county-8s4bt3',
        'maxzoom': zoomThreshold,
        'type': 'fill',
        'paint': {
            'fill-color': {
                property: 'c_adj_supp',
                stops: [
                   [0.00001, '#848484'],
                    [0.2, '#ff0000'],
                    [0.5, '#ff976a'],
                    [0.67, '#e0e8ff'],
                    [0.77, '#98beff'],
                    [2, '#3061ff']
                ],
            },
            'fill-opacity': 0.75
        }
    }, 'waterway-label');
    
  
    map.addLayer({
        'id': 'data_2015_sd-325i5c',
        'source': 'data_2015_sd-325i5c',
        'source-layer': 'data_2015_sd-325i5c',
        'minzoom':zoomThreshold,
        'maxzoom': zoomThreshold1,
        'type': 'fill',
        'paint': {
            'fill-color': {
                property: 'sd_adj_sup',
                stops: [
                   [0.00001, '#848484'],
                    [0.2, '#ff0000'],
                    [0.5, '#ff976a'],
                    [0.67, '#e0e8ff'],
                    [0.77, '#98beff'],
                    [2, '#3061ff']
                ]
            },
            'fill-opacity': 0.75
        }
    }, 'waterway-label');
    
    map.addLayer({
        'id': 'data_2015_ct-8iqhhx',
        'source': 'data_2015_ct-8iqhhx',
        'source-layer': 'data_2015_ct-8iqhhx',
        'minzoom':zoomThreshold1,
        'type': 'fill',
        'paint': {
            'fill-color': {
                property: 'ct_adj_sup',
                stops: [
                    [0.00001, '#848484'],
                    [0.2, '#ff0000'],
                    [0.5, '#ff976a'],
                    [0.67, '#e0e8ff'],
                    [0.77, '#98beff'],
                    [2, '#3061ff']
                ]
            },
            'fill-opacity': 0.75
        }
    }, 'waterway-label');
  
});


map.on('mousemove', function(e) {
  var county = map.queryRenderedFeatures(e.point, {
    layers: ['data_2015_county-8s4bt3']
  });

  if (county.length > 0) {
    document.getElementById('pd').innerHTML = '<h4>' + county[0].properties.county + '</strong></h4><h4><strong><em>' + county[0].properties.c_adj_supp.toFixed(2)  + '</strong> adjusted slots per kid</em></h4>';
 
  } else {
    document.getElementById('pd').innerHTML = '<h4>[Slots per Kid]</h4>';
  }
});


map.on('mousemove', function(e) {
  var county = map.queryRenderedFeatures(e.point, {
    layers: ['data_2015_county-8s4bt3']
  });

  if (county.length > 0) {
    document.getElementById('pd_a').innerHTML = '</strong></h4><h4><strong><em>' +'$'+ county[0].properties.c_totcost_.toFixed(1)  + '</strong> weekly total cost</em></h4>';
 
  } else {
    document.getElementById('pd_a').innerHTML = '<h4>[Weekly Total Cost]</h4>';
  }
});

map.on('mousemove', function(e) {
  var school_dis = map.queryRenderedFeatures(e.point, {
    layers: ['data_2015_sd-325i5c']
  });

  if (school_dis.length > 0) {
    document.getElementById('pd2').innerHTML = '<h4>' + school_dis[0].properties.school_dis +' School District'+ '</strong></h4><h4><strong><em>' + school_dis[0].properties.sd_adj_sup.toFixed(2)  + '</strong> adjusted slots per kid</em></h4>';
 
  } else {
    document.getElementById('pd2').innerHTML = '<h4>Hover over a region!</h4>';
  }
});

map.on('mousemove', function(e) {
  var school_dis = map.queryRenderedFeatures(e.point, {
    layers: ['data_2015_sd-325i5c']
  });

  if (school_dis.length > 0) {
    document.getElementById('pd2_a').innerHTML = '</strong></h4><h4><strong><em>' +'$'+ school_dis[0].properties.sd_totcost.toFixed(1)  + '</strong> weekly total cost</em></h4>';
 
  } else {
    document.getElementById('pd2_a').innerHTML = '<h4>[Weekly Total Cost]</h4>';
  }
});

map.on('mousemove', function(e) {
  var TRACTCE10 = map.queryRenderedFeatures(e.point, {
    layers: ['data_2015_ct-8iqhhx']
  });

  if (TRACTCE10.length > 0) {
    document.getElementById('pd2').innerHTML = '<h4>' + TRACTCE10[0].properties.TRACTCE10 +' School District'+ '</strong></h4><h4><strong><em>' + TRACTCE10[0].properties.ct_adj_sup.toFixed(2)  + '</strong> adjusted slots per kid</em></h4>';
 
  } else {
    document.getElementById('pd3').innerHTML = '<h4>Census-tract level!</h4>';
  }
});
 
 
 map.on('mousemove', function(e) {
  var TRACTCE10 = map.queryRenderedFeatures(e.point, {
    layers: ['data_2015_ct-8iqhhx']
  });

  if (TRACTCE10.length > 0) {
    document.getElementById('pd2_a').innerHTML = '</strong></h4><h4><strong><em>' +'$'+ TRACTCE10[0].properties.ct_totcost.toFixed(1)  + '</strong> weekly total cost</em></h4>';
 
  } else {
    document.getElementById('pd3_a').innerHTML = '<h4>[Weekly Total Cost]</h4>';
  }
});

var stateLegendEl = document.getElementById('state-legend');
var countyLegendEl = document.getElementById('county-legend');
map.on('zoom', function() {
    if (map.getZoom() > zoomThreshold) {
        stateLegendEl.style.display = 'none';
        countyLegendEl.style.display = 'block';
    } else {
        stateLegendEl.style.display = 'block';
        countyLegendEl.style.display = 'none';
    }
});

map.addControl(new MapboxGeocoder({
    accessToken: mapboxgl.accessToken
}));

  var tooltip = d3.select("body").append("div");
map.addControl(new mapboxgl.FullscreenControl());


// Add zoom and rotation controls to the map.
map.addControl(new mapboxgl.NavigationControl());


var layer = document.getElementById('layer');
var colors = [
    '#ffffcc',
    '#a1dab4',
    '#41b6c4',
    '#2c7fb8',
    '#253494',
    '#fed976',
    '#feb24c',
    '#fd8d3c',
    '#f03b20',
    '#bd0026'
];

colors.forEach(function(color) {
    var swatch = document.createElement('button');
    swatch.style.backgroundColor = color;
    swatch.addEventListener('click', function() {
        map.setPaintProperty(layer.value, 'fill-color', color);
    });
    swatches.appendChild(swatch);
});

</script>



</body>
</html>  